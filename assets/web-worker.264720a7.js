import{g as e}from"./vendor.3b914477.js";function t(e,t,a,n,s){const o=e.get(a);let i={ctx:t,noiseFn:function(e,t){return o.noise3D(e/10,t/10,1)},params:s};t.clearRect(0,0,t.canvas.width,t.canvas.height);let r=function(e){const{ctx:t,noiseFn:a,params:{n1:n,n2:s,distortion:o,dotDiameter:i}}=e;let r=-20,c=i/2,d=t.canvas.width,l=t.canvas.height,h=new Path2D;for(let g=r;g<l-r;g++)for(let e=r;e<d-r;e++){let t=e*(i+1)+0+.5+c,r=g*(i+1)+0+.5+c,d=t+o*a(t/n,r/s),l=r+o*a(t/s,r/n);h.rect(d,l,1,1)}return[h]}(i);t.fillStyle=n,t.fill(r[0])}class a{constructor(){this._seed=""}get(t){return this._seed===t&&this._noise||(this._noise=new e(t),this._seed=t),this._noise}}const n=self;!function(){let e,s,o,i,r=new a,c="red";n.onmessage=a=>{if(console.log("Worker got",a.data),a.data.canvas)return e=a.data.canvas,void(s=e.getContext("2d"));if(s)if(a.data.width&&a.data.height&&(s.canvas.width=a.data.width,s.canvas.height=a.data.height),s.canvas.width&&s.canvas.height)switch(a.data.type){case"run":o=a.data.seed||void 0,c=a.data.color||"red",i=a.data.params,t(r,s,o,c,i);break;case"get-image":e.convertToBlob({quality:1}).then((function(e){n.postMessage({type:"image-blob",blob:e})}));break;case"get-preview":{let t=a.data.dimention||32;const s=new OffscreenCanvas(t,t),r=s.getContext("2d");if(r){let a=Math.min(e.width,e.height);r.drawImage(e,0,0,a,a,0,0,t,t),s.convertToBlob().then((function(e){let t={type:"preview-blob",blob:e,renderParams:{seed:o,color:c,genParams:i}};n.postMessage(t)}))}break}}else console.log("no dim yet");else console.log("no ctx yet")},n.postMessage("Worker waiting")}();
