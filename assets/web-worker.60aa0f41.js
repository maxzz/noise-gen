import{g as e}from"./vendor.e1f6e4c4.js";class t{constructor(){this._seed=""}get(t){return this._seed===t&&this._noise||(this._noise=new e(t),this._seed=t),this._noise}}const a=self;function n(e,t,a){const n=e.get(a.seed);let s={ctx:t,noiseFn:function(e,t){return n.noise3D(e/10,t/10,1)},params:a.genParams};t.clearRect(0,0,t.canvas.width,t.canvas.height);let i=function(e){const{ctx:t,noiseFn:a,params:{n1:n,n2:s,distortion:i,dotDiameter:o}}=e;let c=-20,r=o/2,d=t.canvas.width,l=t.canvas.height,h=new Path2D;for(let g=c;g<l-c;g++)for(let e=c;e<d-c;e++){let t=e*(o+1)+0+.5+r,c=g*(o+1)+0+.5+r,d=t+i*a(t/n,c/s),l=c+i*a(t/s,c/n);h.rect(d,l,1,1)}return[h]}(s);t.fillStyle=a.color,t.fill(i[0])}!function(){let e,s,i=new t,o={};a.onmessage=t=>{if("init"===t.data.type)return e=t.data.canvas,void(s=e.getContext("2d"));if(s)if("run"===t.data.type&&t.data.canvasWidth&&t.data.canvasHeight&&(s.canvas.width=t.data.canvasWidth,s.canvas.height=t.data.canvasHeight),s.canvas.width&&s.canvas.height)switch(t.data.type){case"run":o=t.data.renderParams,n(i,s,o);break;case"get-preview":{let n=t.data.smallWidth,s=t.data.smallHeight;const i=new OffscreenCanvas(n,s),c=i.getContext("2d");if(c){let t=Math.min(e.width,e.height);c.drawImage(e,0,0,t,t,0,0,n,s),i.convertToBlob().then((function(e){a.postMessage({type:"preview-blob",blob:e,renderParams:o})}))}break}case"get-image":{const n=t.data.promiseId;e.convertToBlob({quality:1}).then((function(e){a.postMessage({type:"got-image",blob:e,resolveId:n})}));break}}else console.log("no canvas size yet");else console.log("no ctx yet")}}();
